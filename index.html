<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BorzWear - Каталог одежды с Firebase</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #fafafa;
    padding: 40px 20px;
    color: #222;
  }
  h1 {
    font-size: 2.8rem;
    text-align: center;
    margin-bottom: 30px;
  }
  form {
    max-width: 700px;
    margin: 0 auto 40px auto;
    background: #fff;
    padding: 30px 35px;
    border-radius: 14px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.1);
  }
  label {
    display: block;
    font-size: 1.3rem;
    margin-top: 20px;
    margin-bottom: 8px;
  }
  input[type="text"], input[type="number"], input[type="tel"], select {
    width: 100%;
    font-size: 1.3rem;
    padding: 14px 16px;
    border-radius: 8px;
    border: 1.8px solid #ccc;
    box-sizing: border-box;
    transition: border-color 0.25s ease;
  }
  input[type="file"] {
    margin-top: 8px;
  }
  button {
    margin-top: 30px;
    width: 100%;
    font-size: 1.6rem;
    padding: 18px 0;
    background: #007bff;
    border: none;
    color: white;
    border-radius: 12px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,123,255,0.6);
    transition: background 0.3s ease;
  }
  button:hover {
    background: #0056b3;
  }
  td img {
    width: 80px;
    height: auto;
    border-radius: 8px;
  }
</style>
</head>
<body>
<h1>Каталог одежды BorzWear</h1>
<form id="productForm">
  <label for="name">Название</label>
  <input type="text" id="name" required />

  <label for="price">Цена (€)</label>
  <input type="number" id="price" required />

  <label for="size">Размер</label>
  <input type="text" id="size" required />

  <label for="city">Город</label>
  <input type="text" id="city" required />

  <label for="phone">Телефон</label>
  <input type="tel" id="phone" required />

  <label for="photo">Фото товара</label>
  <input type="file" id="photo" accept="image/*" required />

  <button type="submit">Добавить</button>
</form>

<table id="catalogTable" border="1" style="width: 100%; margin-top: 30px;">
  <thead>
    <tr>
      <th>Фото</th>
      <th>Название</th>
      <th>Цена</th>
      <th>Размер</th>
      <th>Город</th>
      <th>Телефон</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";
import { getStorage, ref as storageRef, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyC0hHhfsxKpg22ThVOqmjrIEF-3adLCiAY",
  authDomain: "borzwearcatalog.firebaseapp.com",
  databaseURL: "https://borzwearcatalog-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "borzwearcatalog",
  storageBucket: "borzwearcatalog.appspot.com",
  messagingSenderId: "1047897032543",
  appId: "1:1047897032543:web:9599f9798ca0e56ba858ea",
  measurementId: "G-0KQPZ02Z5T"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const storage = getStorage(app);
const catalogRef = ref(db, 'catalog');

const form = document.getElementById('productForm');
const tableBody = document.querySelector('#catalogTable tbody');

form.addEventListener('submit', async e => {
  e.preventDefault();

  const file = document.getElementById('photo').files[0];
  if (!file) return alert("Пожалуйста, выберите фото.");

  const photoRef = storageRef(storage, 'images/' + Date.now() + '_' + file.name);
  await uploadBytes(photoRef, file);
  const photoURL = await getDownloadURL(photoRef);

  const product = {
    name: form.name.value.trim(),
    price: form.price.value.trim(),
    size: form.size.value.trim(),
    city: form.city.value.trim(),
    phone: form.phone.value.trim(),
    photo: photoURL
  };

  push(catalogRef, product);
  form.reset();
});

onValue(catalogRef, snapshot => {
  tableBody.innerHTML = '';
  snapshot.forEach(childSnapshot => {
    const item = childSnapshot.val();
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><img src="${item.photo}" alt="${item.name}" /></td>
      <td>${item.name}</td>
      <td>${item.price}</td>
      <td>${item.size}</td>
      <td>${item.city}</td>
      <td><a href="tel:${item.phone}">${item.phone}</a></td>
    `;
    tableBody.appendChild(tr);
  });
});
</script>
</body>
</html>
